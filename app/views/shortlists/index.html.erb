<%= form_tag shortlists_path, id: "list-search", method: :get do %>
<p>
  <%= text_field_tag "query", nil, list: "haha",  placeholder: "Search" %><br>
  <datalist id="haha">
    
  </datalist>
  <%= submit_tag "Search", :name => nil %>
<%end%>

<%for i in @list do%>
	<%@restaurant = Restaurant.find(i.restaurant_id)%>
	<%= @restaurant.name%> <%=link_to "Delete", shortlist_path(i.id), method: :delete%><br>
	<%= @restaurant.location%><br>
	<hr>
<%end%>

<script>
$("#list-search").on("keyup", function(){
  autocomplete()
});

function autocomplete(){
	// let search = $("#listings-search").serialize()
	// console.log("serialize")
	// console.log(search);
	console.log("I am inside of autocomplete")
	// let query = $("#city-search").serialize();
	// console.log("==============")
	// console.log(query);
  $.ajax({
    url: '/findlist',
    type: 'POST',
    data: $("#list-search").serialize(), //takes the form data and authenticity token and converts it into a standard URL
    dataType: 'json', //specify what type of data you're expecting back from the servers
    error: function(request, status, error) {
    	alert(request.responseText);
        console.log("Something went wrong");
    },
    success: function(data) {
    	console.log(" I am back in javascript ajax");
      	console.log(data)
      	let list = $("#haha")
      	console.log(list);	
      $("#haha").html("");

      data.forEach(function(element) {
        var option = document.createElement("option");
        option.value = element.name;
        console.log(element.name)
        console.log(option)

        // append option to list
        $("#haha").append(option);
      });
    }
  });
}
</script>